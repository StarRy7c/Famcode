<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CrixZy Events</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap');
        :root {
            --primary-glow: rgba(99, 102, 241, 0.5);
            --secondary-glow: rgba(124, 58, 237, 0.8);
        }
        * { box-sizing: border-box; }
        body {
            background: linear-gradient(-45deg, #0f172a, #1e1b4b, #312e81, #1e293b);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: white;
            font-family: 'Inter', sans-serif;
            padding: 16px;
            min-height: 100vh;
            overflow-x: hidden;
        }
        @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        @keyframes fadeInUp { 0% { opacity: 0; transform: translateY(50px); } 100% { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInLeft { 0% { opacity: 0; transform: translateX(-50px); } 100% { opacity: 1; transform: translateX(0); } }
        @keyframes fadeInRight { 0% { opacity: 0; transform: translateX(50px); } 100% { opacity: 1; transform: translateX(0); } }
        
        .title {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0, #cbd5e1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .match-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.5), rgba(51, 65, 85, 0.5));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            opacity: 0; /* Start hidden for animation */
        }
        .match-card.animate-in { animation: fadeInUp 0.7s ease-out forwards; }
        .match-card.animate-left { animation: fadeInLeft 0.7s ease-out forwards; }
        .match-card.animate-right { animation: fadeInRight 0.7s ease-out forwards; }
        .match-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4), 0 0 40px var(--primary-glow);
            border-color: var(--primary-glow);
        }
        .card-header { position: relative; }
        .match-img {
            width: 100%;
            height: 192px;
            object-fit: cover;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }
        .logo-placeholder {
            width: 100%; height: 192px; background: #1e293b; border-top-left-radius: 20px; border-top-right-radius: 20px;
            display: flex; align-items: center; justify-content: center; font-size: 3rem;
        }
        .status-badge {
            position: absolute; top: 1rem; right: 1rem; padding: 4px 12px;
            border-radius: 20px; font-weight: 700; font-size: 0.8rem;
            background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .status-badge.live { background-color: #ef4444; border: none; }
        .card-content { padding: 1.5rem; text-align: center; }
        .match-title { font-size: 1.2rem; font-weight: 700; margin-bottom: 0.5rem; }
        .match-teams { font-size: 1rem; color: #cbd5e1; margin-bottom: 1.5rem; }
        .btn {
            padding: 12px 24px; border-radius: 25px; font-weight: 700;
            transition: all 0.3s ease; text-decoration: none; display: inline-block; margin: 5px;
            background: linear-gradient(135deg, #7c3aed, #6366f1);
            color: white; box-shadow: 0 8px 25px rgba(124, 58, 237, 0.3);
        }
        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 30px rgba(124, 58, 237, 0.5);
        }
        .disclaimer { text-align: center; margin-top: 40px; padding: 20px; font-size: 0.9rem; color: #94a3b8; }
    </style>
</head>
<body>
    <h1 class="title">üèè CrixZy Upcoming Events</h1>
    <main id="events-container" class="grid gap-8 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"></main>
    <footer class="disclaimer">
        <p>‚ö†Ô∏è <strong>Disclaimer:</strong> All content is fetched from public sources. We do not host any content.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const eventsContainer = document.getElementById('events-container');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const card = entry.target;
                        const cardIndex = Array.from(card.parentElement.children).indexOf(card);
                        
                        // Staggered slide-in animation based on column
                        if (cardIndex % 3 === 0) card.classList.add('animate-left');
                        else if (cardIndex % 3 === 1) card.classList.add('animate-in');
                        else card.classList.add('animate-right');
                        
                        observer.unobserve(card); // Animate only once
                    }
                });
            }, { threshold: 0.1 });

            /**
             * Parses the custom date string "HH:mm:ss AM/PM DD-MM-YYYY" into a valid Date object.
             */
            function parseStartTime(dateString) {
                if (!dateString) return null;
                try {
                    const parts = dateString.split(' ');
                    const time = parts[0];
                    const ampm = parts[1].toUpperCase();
                    const [day, month, year] = parts[2].split('-');
                    // Reassemble into a format JS understands reliably: YYYY-MM-DDTHH:mm:ss
                    const isoString = `${year}-${month}-${day}T${time}`;
                    const date = new Date(isoString);
                    // Adjust for AM/PM
                    if (ampm === 'PM' && date.getHours() < 12) {
                        date.setHours(date.getHours() + 12);
                    } else if (ampm === 'AM' && date.getHours() === 12) {
                        date.setHours(0); // Handle midnight case
                    }
                    return date;
                } catch (e) {
                    return null;
                }
            }

            /**
             * Determines the status of the match (Live, Today, Tomorrow, or a specific date).
             */
            function getMatchStatus(match) {
                if (match.status === 'LIVE') {
                    return '<span class="status-badge live">üî¥ LIVE</span>';
                }
                const eventTime = parseStartTime(match.startTime);
                if (!eventTime) return '';

                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                const eventDay = new Date(eventTime.getFullYear(), eventTime.getMonth(), eventTime.getDate());

                if (today.getTime() === eventDay.getTime()) {
                    return `<span class="status-badge">TODAY at ${eventTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</span>`;
                }
                if (tomorrow.getTime() === eventDay.getTime()) {
                    return '<span class="status-badge">TOMORROW</span>';
                }
                return `<span class="status-badge">${eventTime.toLocaleDateString([], { month: 'short', day: 'numeric' })}</span>`;
            }

            async function fetchAndDisplayEvents() {
                const targetUrl = "https://raw.githubusercontent.com/drmlive/fancode-live-events/main/fancode.json";
                const proxies = ["https://api.allorigins.win/raw?url=", "https://corsproxy.io/?"];
                let events = null;

                for (const proxy of proxies) {
                    try {
                        const response = await fetch(proxy + encodeURIComponent(targetUrl));
                        if (!response.ok) throw new Error(`Fetch failed with status ${response.status}`);
                        events = await response.json();
                        break; // Success, exit loop
                    } catch (error) {
                        console.error(`Attempt via ${proxy} failed:`, error);
                    }
                }

                if (!events || !Array.isArray(events)) {
                    eventsContainer.innerHTML = `<div class="col-span-full text-center p-8 bg-red-900 bg-opacity-30 rounded-lg">
                        <h2 class="text-2xl font-bold text-red-400 mb-2">üö® Could Not Load Events</h2>
                        <p class="text-gray-300">Please check your connection or try again later.</p>
                    </div>`;
                    return;
                }

                // **The provided JSON is a direct array, so we access it directly.**
                events.forEach(match => {
                    const card = document.createElement('div');
                    card.className = 'match-card';
                    
                    const statusHTML = getMatchStatus(match);
                    
                    card.innerHTML = `
                        <div class="card-header">
                            ${match.src ? 
                              `<img class="match-img" src="${match.src}" alt="${match.event_name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                               <div class="logo-placeholder" style="display:none;">üèè</div>` :
                              `<div class="logo-placeholder">üèè</div>`
                            }
                            ${statusHTML}
                        </div>
                        <div class="card-content">
                            <h3 class="match-title">${match.event_name || 'Cricket Match'}</h3>
                            <p class="match-teams">${match.match_name || 'Teams TBD'}</p>
                            <a href="https://starry7c.github.io/CrixzyLive?stream=${encodeURIComponent(match.dai_url)}" target="_blank" class="btn">üé¨ Watch Live</a>
                        </div>
                    `;
                    eventsContainer.appendChild(card);
                    observer.observe(card); // Observe card for scroll animation
                });
            }

            fetchAndDisplayEvents();
        });
    </script>
</body>
</html>
